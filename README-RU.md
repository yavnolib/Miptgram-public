# MIPTGRAM Social Network

Этот репозиторий содержит исходный код кроссплатформенной социальной сети MIPTGRAM, созданной студентами МФТИ для студентов МФТИ. Проект был разработан в качестве итогового проекта по дисциплине "Компьютерные технологии" за 4-й семестр.

<img src="https://sun9-34.userapi.com/impg/Whg5fUIxnHlEXY3ejbC9ewgDaEMAROugw3yJaw/G7GZCV__R6U.jpg?size=727x471&quality=96&sign=fc79adb5cf69239d3b453c63ac912b83&type=album" alt="miptgram" width="200"/>


## Table of Contents

- [Команда](#команда)
- [Цель](#цель)
- [Технический стек](#технический-стек)
- [Возможности](#возможности)
- [О проекте](#о-проекте)
- [Базы данных](#базы-данных)
- [Ассинхроннсть и многопоточность](#ассинхронность-и-многопоточность)
- [Меню приложения](#меню-приложения)
- [Установка](#установка)
- [Лицензия](#лицензия)
- [Будущие планы](#будущие-планы)

## Команда
- Амадей Воронцов
- Ярослав Николаев
- Иван Чевычелов
- Лена Земскова

## Цель 
Целью проекта MIPTgram является создание кросс-платформенной социальной сети для студентов Московского физико-технического института (МФТИ), доступной на любом устройстве. Она призвана объединить студентов и предоставить им множество функций, таких как расписание, лента новостей и построение графиков для лабораторных работ. Создавая социальную сеть, адаптированную к потребностям студентов МФТИ, команда проекта надеется улучшить общение и сотрудничество между студентами и способствовать их академическим успехам. Проект также служит итоговым проектом для 4-го семестра курса "Компьютерные технологии" в МФТИ.

## Технический стек
- Flutter Framework
- Dart language
- Rive
- Linux administration
- Python for server's apps (Flask, matplotlib, numpy)
- PostgreSQL
- NoSQL
- C/C++
- Swift
- Kotlin
- Object Oriented Programming
- Parallel programming usinc acync/await template, Future and Stream objects; using multiprocessing on the server side of the application

## Возможности
- Чат между студентами и профессорами (в будущем)
- Расписание предметов для студентов 
- Phystech.Conversations, платформа для анонимных сообщений
- Обработчик лабораторных работ по общей физике, включающий результаты лабораторных работ, расписания и материалы (в будущем)

## О проекте

MIPTGRAM - это социальная сеть для студентов МФТИ, которая может работать на любом устройстве и в веб-браузере. В качестве языка программирования для проекта выбран объектно-ориентированный язык Dart с использованием фреймворка Flutter, который отдельно компилируется в C++, HTML, Kotlin или Swift в зависимости от платформы. Вся серверная часть написана на языке Python. Для создания анимации использовалось отдельное приложение Rive. 
На данный момент в приложении есть регистрация и авторизация аккаунта, расписание, которое обновляется для каждого студента, лента новостей Phystech.Confessions и построитель графиков для лабораторных работ.

## Базы данных

PostgreSQL используется как система управления базой данных, в которой есть таблицы, поскольку это реляционная база данных. База данных размещается на компьютере с внешним интерфейсом, и к ней можно подключиться из любого места. 

База данных PostgreSQL имеет несколько таблиц, в том числе:
- `groups`: содержит полное имя группы и идентификатор группы

![](https://sun9-79.userapi.com/impg/RAdjGAO6ymnpR-okPcIUWT-tDmhBqptYYruBsQ/rqTcLrKP7b8.jpg?size=296x117&quality=96&sign=b57bb6deb703039450b50275907d5923&type=album)

- `users`: содержит идентификатор пользователя, имя, фамилию, идентификатор группы, пароль, почту. Вместо паролей хранится MD5-хэш 'password' + 'kisy lubish'. В PostgreSQL этот хэш просто вычисляется с помощью функции `md5(concat(password, 'kisy lubish'))`.

![](https://sun9-73.userapi.com/impg/kcOOUpA2YaLTwBQFFz5AXxO6QS31mfr_1dxxYA/LW0eTiBl94c.jpg?size=855x153&quality=96&sign=61def97c14340b502eee6549fcca2a75&type=album)

- `pairs`: содержит идентификатор пары и время пары

![](https://sun9-52.userapi.com/impg/XNreuR6XGa-D5HoImX1lFfZHustHAlJJO0ZFPA/FfbMzjgHB-U.jpg?size=284x187&quality=96&sign=235f2fe15bdba0dcc3fb438a7e6e109d&type=album)

- `weekdays`: таблица с днями недели

![](https://sun9-71.userapi.com/impg/hcvKCUXqV0gG67ly0qG8TOfBN1B43ljKEgdf9w/h0gGFtN6w5E.jpg?size=301x193&quality=96&sign=1be81fdc17cbaec8f016441e4fd954b1&type=album)

- `subjects`: таблица со всевозможными предметами

![](https://sun9-58.userapi.com/impg/x3ZaDS9hPmdU0FNkgEHcT9487IPQrHEyczRmQA/1e8tgUD_mrg.jpg?size=339x158&quality=96&sign=7a30b90bba00d313dc43d90f43d9497d&type=album)

- `schedule`: таблица с расписанием, где каждый столбец - это идентификаторы, их можно объединить в таблицы и получить все тексты.

![](https://sun9-10.userapi.com/impg/WlWITBjl8dVsZQAoy0si4-eJsILJiZCCDSm7bQ/VgnrpNxDIzM.jpg?size=401x243&quality=96&sign=ebb01301aa6f4491e9c29b7414ac46a7&type=album)

- `posts`: таблица со всеми постами.

Кроме того, для каждой платформы существует локальная база данных. Это база данных NoSQL, которая используется для сохранения информации и пользователя, чтобы не просить его каждый раз входить в систему, и старых сообщений, чтобы не загружать их каждый раз.

## Ассинхронность и многопоточность

На стороне клиента используется шаблон `async/await`, с помощью которого все запросы к базе данных выполняются параллельно. Например, при проверке логина и пароля параллельно происходит отправка информации на сервер и отображение загрузки анимации. При обновлении расписания или написании нового поста обращение к базе данных происходит параллельно с остальной частью приложения, поэтому приложение не зависает, и пользователь может пользоваться им во время отправки данных.

На стороне сервера для построения графиков используется программа на Python с библиотеками Flask, NumPy и Matplotlib. Главный процесс - это родительский процесс, который сидит и слушает входящие запросы. Для каждого запроса он запускает отдельный процесс, который отправляет картинку родительскому процессу. Это было сделано для обработки большого количества запросов и для того, чтобы избежать утечек памяти, которые допускаются библиотекой Matplotlib.

Когда Matplotlib рисует график, происходит утечка памяти. Он запрашивает холст (память для хранения информации о форме, о графике), рисует на этом холсте, но выделенная память никак не освобождается, и это не фиксируется, потому что это заложено в самом движке библиотеки. Поэтому для рисования графика нужен отдельный процесс. Когда процесс рисования рисует график, он просто умирает, и таким образом освобождает всю выделенную ему память, включая память для холста.

## Меню приложения

Приложение MIPTGram имеет следующие основные меню и функции:

0. **Главное окно**: Это окно является первым окном, которое появляется при запуске приложения. В нем отображается анимация и логотип приложения.
<img src="https://sun9-10.userapi.com/impg/vxHx4kiCvqC2ZKGmg1JWqOqzRyq6Em9Ny3EVCQ/2yEVshjlru4.jpg?size=886x1920&quality=96&sign=3f611fb6fe4d5cadc88985361a5fe02d&type=album" alt="main window" width="200"/>

1. **Окно входа**: Это окно позволяет пользователям либо зарегистрировать новую учетную запись, либо войти в существующую. Когда пользователь нажимает кнопку входа, приложение посылает запрос в базу данных. Если запрос успешен, приложение извлекает всю информацию о пользователе, включая его расписание и новые сообщения. При последующих посещениях приложение больше не будет отображать эту информацию, поскольку она будет сохранена на устройстве пользователя.
<img src="https://sun9-73.userapi.com/impg/F5FVLAU7exII14EDnTtm8cFjh-iK0kpAMoRAYg/O1h7PU1B_pI.jpg?size=886x1920&quality=96&sign=de55bda8b59077d52fe35f7ffe965b3d&type=album" alt="login window" width="200"/>

2. **Окно расписания**: В этом окне отображается расписание пользователя со всеми его предметами. Пользователь может провести пальцем влево или вправо, чтобы переключиться между днями недели, добавить новый предмет в расписание или удалить предмет. Любые изменения, внесенные в расписание, обновляют базу данных.
<img src="https://sun9-58.userapi.com/impg/4JqiU1bKkKpCtVgXdHBJFyOBRjNzK71ZKqSEKg/inF8CVF-1FE.jpg?size=886x1920&quality=96&sign=790c4e206fb6b29e2cd272c9a73645d8&type=album" alt="schedule window" width="200"/>

3. **Боковое меню**: Боковое меню позволяет пользователям переключиться на любое из других окон, просмотреть личную информацию или выйти из учетной записи.
<img src="https://sun9-48.userapi.com/impg/6AAvy4pep-gWgiXSKTW84SW6Z9FykO95I2pL4g/3w7xz6ZcPtU.jpg?size=886x1920&quality=96&sign=ef90f93b2907cb1d1eb54c175037dfed&type=album" alt="side menu" width="200"/>

4. **Окно Phystech.Confessions**: В этом окне отображаются сообщения, которые видны всем пользователям. Пользователи могут добавить новый пост, который обновляет базу данных и позволяет другим пользователям прочитать его.
<img src="https://sun9-69.userapi.com/impg/AMAti5Yz-ipBMAq893fmx_O2YxDSSsWt_dL8MQ/IrKSzAQ2Teo.jpg?size=886x1920&quality=96&sign=59aa9dd4979c111fefa4aad0c9156508&type=album" alt="confessions window" width="200"/>

5. **Окно построителя графиков**: В этом окне пользователи могут вводить данные, которые приложение отправляет на сервер для обработки по методу наименьших квадратов. Также рассчитывается ошибка, и на выходе получается график данных, который пользователи могут использовать для оформления своей лабораторной работы.

<img src="https://sun9-9.userapi.com/impg/LyB83cKRrg8xQEgpfIFA8-YyIKGU1mIFZTyzsw/N4zet6udtR4.jpg?size=804x606&quality=96&sign=f2139840c2be57c009c18e54615ddb57&type=album" alt="graph" width="400"/>

## Установка
Для установки скачайте последнюю версию [здесь](https://github.com/vorontsov-amd/Miptgram/tags)

* Для Android:
  + Загрузите miptgram.apk.tar.gz на ваш смартфон на базе Android из последней версии по кнопке "Релизы" в этом репозитории.
  + Извлеките и установите miptgram.apk из этого архива.
  + Пользуйтесь с удовольствием!
  
* Для Linux:
  + Загрузите linux-app.tar.gz на ваше устройство на базе Linux с последней версии по кнопке "Releases" в этом репозитории.
  + Извлеките папку "release" из этого архива.
  + Перейдите в эту папку:
  ```
  cd release/bundle
  chmod +x Miptgram
  ```
  + Запустите приложение двойным щелчком на Miptgram в /release/bundle или напишите эту команду в /release/bundle:
  ```
  ./Miptgram
  ```
  + Используйте с удовольствием!

Чтобы установить и запустить проект MIPTgram из репозитория github, выполните следующие шаги:
1. Клонируйте репозиторий: `git clone https://github.com/vorontsov-amd/Miptgram.git`.
2. Установите Flutter SDK: следуйте инструкциям на [сайте Flutter] (https://flutter.dev/docs/get-started/install).
3. Установите PostgreSQL: следуйте инструкциям на [сайте PostgreSQL](https://www.postgresql.org/download/).
4. Обновите зависимость `flutter pub get`.
6. Запустите клиент: `flutter run`

## Лицензия
Проект MIPTgram лицензируется по лицензии MIT License. Вы можете найти копию лицензии в файле `LICENSE` в репозитории проекта. Лицензия MIT - это разрешительная лицензия свободных программ, которая допускает повторное использование в составе несвободных программ, а также свободных программ с открытым исходным кодом. Она позволяет модифицировать, распространять и использовать программное обеспечение в личных целях при условии сохранения оригинальных авторских прав и лицензионных уведомлений.

## Планы на будущее

В будущем команда MIPTGram планирует добавить в приложение чат, чтобы пользователи могли общаться друг с другом. Они также планируют улучшить пользовательский интерфейс и добавить в приложение больше функций, таких как уведомления и возможность делиться сообщениями.
